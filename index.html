<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Magic - UAE</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-50 min-h-screen flex flex-col items-center p-4">
    <div class="max-w-md w-full bg-white rounded-2xl shadow-xl p-8 mt-10">
        <h1 class="text-3xl font-extrabold text-center text-indigo-600 mb-2">ðŸ“¸ Photo Magic</h1>
        <p class="text-gray-500 text-center mb-8">AI-Powered Event Photos</p>

        <div class="border-2 border-dashed border-indigo-100 rounded-xl p-6 mb-6 text-center">
            <h3 class="font-bold text-gray-700 mb-4">Host / Photographer</h3>
            <input type="file" id="photoInput" multiple class="block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100 mb-4">
            <button onclick="uploadPhotos()" id="uploadBtn" class="w-full bg-indigo-600 text-white font-bold py-3 rounded-lg hover:bg-indigo-700 transition">Upload to Drive</button>
        </div>

        <div class="bg-indigo-50 rounded-xl p-6 text-center">
            <h3 class="font-bold text-gray-700 mb-4">Find My Photos</h3>
            <button onclick="takeSelfie()" class="w-full bg-emerald-500 text-white font-bold py-3 rounded-lg hover:bg-emerald-600 transition">Take Selfie & Search</button>
        </div>

        <div id="status" class="mt-4 text-center text-sm font-medium text-indigo-500"></div>
        <div id="gallery" class="grid grid-cols-2 gap-4 mt-8"></div>
    </div>

    <script>
        // Replace this with your URL from Phase 2
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbz6r6S3clU5VWg5gAtaRlhTIKaBQ7Pf4TQbcBh3rUq-1lg_JLm9cH7DmYA_Jh2njBFC/exec";

        async function uploadPhotos() {
            const files = document.getElementById('photoInput').files;
            const status = document.getElementById('status');
            const btn = document.getElementById('uploadBtn');

            if (files.length === 0) return alert("Select photos first!");

            btn.disabled = true;
            for (let file of files) {
                status.innerText = `Uploading: ${file.name}...`;
                const base64 = await toBase64(file);
                
                try {
                    await fetch(SCRIPT_URL, {
                        method: "POST",
                        body: JSON.stringify({
                            base64: base64.split(',')[1],
                            mimeType: file.type,
                            fileName: file.name
                        })
                    });
                } catch (e) { console.error(e); }
            }
            status.innerText = "âœ… All photos uploaded successfully!";
            btn.disabled = false;
        }

        const toBase64 = file => new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = () => resolve(reader.result);
            reader.onerror = error => reject(error);
        });

        function takeSelfie() {
            alert("Selfie search feature: This will connect to your AI comparison script!");
            // We will add the camera logic in the final polish step!
        }
    </script>
</body>
</html>
